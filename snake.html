<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.10.2/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.10.2/addons/p5.sound.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/molleindustria/p5.play/lib/p5.play.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
    <meta charset="utf-8" />

  </head>
  <body>
    <script>
      
let snake;
let tam = 30;
let long = 1;
let apple;
let node = [false,false,false,false,false,false,false,false,false,false,false,false];

function setup() {
    snake = new Group();
    createCanvas(390, 390);
    let c = createSprite(width/2,height/2, tam, tam);
    c.shapeColor = color(0, 255, 0);
    snake.add(c);

    apple = createSprite(random(0+tam, width-tam), random(0+tam, height-tam), 10, 10)
    apple.shapeColor = color(255, 0, 0);

    frameRate(3);
}

function draw() {
    background(50);
  
    if (snake[0].right) snake[0].position.x += tam;
    else if (snake[0].down) snake[0].position.y += tam;
    else if (snake[0].left) snake[0].position.x -= tam;
    else if (snake[0].up) snake[0].position.y -= tam;
    
  
    if(snake.length>0){
      for (let i = 1; i < snake.length; i++){
      
        if (snake[i].right){
          snake[i].position.x += tam;
        }
      
        else if (snake[i].left){
          snake[i].position.x -= tam;
        }
      
        else if (snake[i].up){
          snake[i].position.y -= tam;
        }
      
        else if (snake[i].down){
          snake[i].position.y += tam; 
        }
        
        if(node[i-1]==true || i==1){
          snake[i].down = snake[i-1].down;
          snake[i].up = snake[i-1].up;
          snake[i].left = snake[i-1].left;
          snake[i].right = snake[i-1].right;
        }
      }
    }
    for(let i = snake.length-2; i>=0; i--){
      if (node[i]==true){
        node[i]=false;
        node[i+1]=true;
        snake[i].shapeColor = color(0, 255, 0);
        snake[i+1].shapeColor = color(0, 0, 255);
      }
    }
    console.log(node)
    snake[0].overlap(apple, ChangePosition);

    drawSprites();
}
      
      
function keyPressed() {
  node[0]=true;
  if (keyCode == RIGHT_ARROW && (!snake[0].left || snake.length==1)) {
      snake[0].right=true;
      snake[0].left=false;
      snake[0].up=false;
      snake[0].down=false;
    }
    else if (keyCode == DOWN_ARROW && (!snake[0].up || snake.length==1)) {
      snake[0].right=false;
      snake[0].left=false;
      snake[0].up=false;
      snake[0].down=true;
    }
    else if (keyCode == LEFT_ARROW && (!snake[0].right || snake.length==1)) {
      snake[0].right=false;
      snake[0].left=true;
      snake[0].up=false;
      snake[0].down=false;
    }
    else if (keyCode == UP_ARROW && (!snake[0].down || snake.length==1)) {
      snake[0].right=false;
      snake[0].left=false;
      snake[0].up=true;
      snake[0].down=false;
    }
}


function ChangePosition(){
    apple.position.x = random(0+tam, width-tam);
    apple.position.y = random(0+tam, height-tam);
  
    let c = createSprite(snake[snake.length-1].position.x, snake[snake.length-1].position.y, tam, tam);
    c.shapeColor = color(255);
    c.right=false;
    c.left=false;
    c.up=false;
    c.down=false;
    snake.add(c);
}
      
    </script>
  </body>
</html>
